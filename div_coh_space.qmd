# Diversification, coherence, and the role of space

Coherence measures the alignment between a technology's directional embedding in the network (incoming vs. outgoing edge strengths to different categories) and the regional average embedding pattern for specialized technologies in that category. 

We construct this metric using cosine similarity which ranges from -1 to 1. Values near 1 indicate (high coherence) indicate the technology's network position matches the region's technological profile; values near 0 (neutral coherence) suggest misalignment between the technology's relational structure and regional specialization patterns; whereas values near -1 suggest a complete mismatch.

For each region-technology-category-year combination, defined as :

$\mathcal{T}$ is the set of technologies, $\mathcal{Y}$ is the set of years, $\mathcal{R}$ is the set of regions, and $\mathcal{C}$ is the set of categories, such that:

$$
\mathcal{T} = \{\,t : 1 \le t \le N_T\},\quad
\mathcal{Y} = \{\,y : 1 \le y \le N_Y\},\quad
\mathcal{R} = \{\,r : 1 \le r \le N_R\},\quad
\mathcal{C} = \{\,c : 1 \le c \le N_C\}.
$$

And $N_T, N_Y, N_R, N_C$ are the total counts of technologies, years, regions and categories

we measure the following cosine similarity:

$$\text{Coherence}_{r,i,t} = \frac{\mathbf{v}_1 \cdot \mathbf{v}_2}{||\mathbf{v}_1|| \cdot ||\mathbf{v}_2||}$$

where:


- $\mathbf{v}_1 = [\text{embcat\_to}_{i}, \overline{\text{embcat\_to}}_{r,c}]$ captures incoming edge patterns
- $\mathbf{v}_2 = [\text{embcat\_from}_{i}, \overline{\text{embcat\_from}}_{r,c}]$ captures outgoing edge patterns


- $\text{embcat\_to}_{i} = \frac{\sum \text{weights\_to}_{i,c}}{\text{count(incoming edges)}_{i,c}}$ measures average incoming edge weight from category $c$ to technology $i$
- $\text{embcat\_from}_{i} = \frac{\sum \text{weights\_from}_{i,c}}{\text{count(outgoing edges)}_{i,c}}$ measures average outgoing edge weight from technology $i$ to category $c$
- weights = Normalised Feature Importance values denoting connection strength between technology pairs. 


- $\overline{\text{embcat\_to}}_{r,c}$ = regional average of incoming embeddesdness for technologies with RCA≥1 in category $c$ within region $r$
- $\overline{\text{embcat\_from}}_{r,c}$ = regional average of outgoing embeddesdness for technologies with RCA≥1 in category $c$ within region $r$






